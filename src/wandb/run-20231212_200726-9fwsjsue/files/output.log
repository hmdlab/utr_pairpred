Total sample size:16819
Loading embedding data ...
Successflly loaded embedding data !!!
Creating train dataset ...
train,13455
Creating val dataset ...
val,1682
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:93: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  self.utr5emb = np.stack(list(np.array(self.seq_emb)[:, 0]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:93: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.utr5emb = np.stack(list(np.array(self.seq_emb)[:, 0]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:94: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  self.utr3emb = np.stack(list(np.array(self.seq_emb)[:, 1]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:94: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.utr3emb = np.stack(list(np.array(self.seq_emb)[:, 1]))
Creating test dataset ...
test,3364

Epoch: 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 81.80it/s]
/home/ksuga/whole_mrna_predictor/.venv/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:152: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch: 2:  14%|████████████████████████████                                                                                                                                                                        | 60/420 [00:00<00:03, 110.37it/s]

Epoch: 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.14it/s]
Epoch: 3:   7%|█████████████                                                                                                                                                                                       | 28/420 [00:00<00:02, 133.14it/s]


Epoch: 3:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 375/420 [00:04<00:00, 102.15it/s]
Epoch: 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.76it/s]

Epoch: 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.79it/s]
Epoch: 5:  17%|█████████████████████████████████▎                                                                                                                                                                   | 71/420 [00:00<00:03, 96.31it/s]

Epoch: 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.08it/s]
Epoch: 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 442.52it/s]
Epoch: 6:   5%|██████████▎                                                                                                                                                                                          | 22/420 [00:00<00:03, 99.60it/s]
Phase:train,Epoch 5, loss:3.464436978385562


Epoch: 6:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 354/420 [00:03<00:00, 88.62it/s]
Epoch: 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.21it/s]

Epoch: 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.21it/s]
Epoch: 8:  17%|█████████████████████████████████▊                                                                                                                                                                   | 72/420 [00:00<00:03, 93.41it/s]

Epoch: 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.09it/s]
Epoch: 9:   3%|█████▌                                                                                                                                                                                              | 12/420 [00:00<00:03, 108.59it/s]


Epoch: 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 84.65it/s]
Epoch: 10:  27%|████████████████████████████████████████████████████▉                                                                                                                                              | 114/420 [00:01<00:03, 99.15it/s]

Epoch: 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.27it/s]
Epoch: 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 382.27it/s]
Epoch: 11:  13%|█████████████████████████▋                                                                                                                                                                          | 55/420 [00:00<00:03, 92.64it/s]
Phase:train,Epoch 10, loss:3.3655974762780327


Epoch: 11:  85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 356/420 [00:04<00:00, 79.35it/s]
Epoch: 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.32it/s]

Epoch: 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 80.83it/s]
Epoch: 13:   6%|███████████▏                                                                                                                                                                                        | 24/420 [00:00<00:05, 71.87it/s]


Epoch: 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.03it/s]
Epoch: 14:   4%|███████▍                                                                                                                                                                                            | 16/420 [00:00<00:05, 72.27it/s]


Epoch: 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 67.89it/s]
Epoch: 15:   4%|███████▍                                                                                                                                                                                            | 16/420 [00:00<00:05, 72.30it/s]



Epoch: 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:07<00:00, 56.47it/s]
Epoch: 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 382.04it/s]
Epoch: 16:   8%|██████████████▉                                                                                                                                                                                     | 32/420 [00:00<00:04, 86.75it/s]
Phase:train,Epoch 15, loss:3.323491241818383


Epoch: 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 76.22it/s]
Epoch: 17:  20%|██████████████████████████████████████▎                                                                                                                                                             | 82/420 [00:01<00:04, 72.75it/s]

Epoch: 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 83.94it/s]
Epoch: 18:   2%|███▊                                                                                                                                                                                                 | 8/420 [00:00<00:05, 70.63it/s]


Epoch: 18:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 365/420 [00:04<00:00, 77.84it/s]
Epoch: 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 85.15it/s]


Epoch: 19:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉            | 394/420 [00:05<00:00, 68.14it/s]
Epoch: 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 72.35it/s]


Epoch: 20:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████             | 392/420 [00:05<00:00, 65.91it/s]
Phase:train,Epoch 20, loss:3.277148673647926
Epoch: 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 74.79it/s]
Epoch: 20: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 363.24it/s]


Epoch: 21:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                | 384/420 [00:05<00:00, 66.00it/s]
Epoch: 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.19it/s]


Epoch: 22:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                      | 371/420 [00:05<00:00, 65.95it/s]
Epoch: 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 66.31it/s]


Epoch: 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 67.87it/s]
Epoch: 24:  12%|██████████████████████▊                                                                                                                                                                             | 49/420 [00:00<00:05, 65.56it/s]


Epoch: 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 65.66it/s]
Epoch: 25:  10%|██████████████████▋                                                                                                                                                                                 | 40/420 [00:00<00:05, 70.21it/s]


Epoch: 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.54it/s]
Epoch: 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 394.78it/s]
Epoch: 26:  13%|██████████████████████████▏                                                                                                                                                                         | 56/420 [00:00<00:03, 98.85it/s]
Phase:train,Epoch 25, loss:3.2517126611300875

Epoch: 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.21it/s]
Epoch: 27:   6%|███████████▏                                                                                                                                                                                        | 24/420 [00:00<00:04, 95.61it/s]


Epoch: 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 81.10it/s]
Epoch: 28:  17%|█████████████████████████████████▌                                                                                                                                                                  | 72/420 [00:00<00:04, 73.51it/s]


Epoch: 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.09it/s]
Epoch: 29:  13%|██████████████████████████▏                                                                                                                                                                         | 56/420 [00:00<00:05, 72.27it/s]


Epoch: 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 78.78it/s]
Epoch: 30:  37%|████████████████████████████████████████████████████████████████████████▌                                                                                                                         | 157/420 [00:01<00:02, 109.46it/s]

Epoch: 30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 93.85it/s]
Epoch: 30: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 460.18it/s]
Epoch: 31:  22%|███████████████████████████████████████████▊                                                                                                                                                        | 94/420 [00:01<00:03, 90.70it/s]
Phase:train,Epoch 30, loss:3.223181054705665

Epoch: 31: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.78it/s]
Epoch: 32:  10%|████████████████████▍                                                                                                                                                                              | 44/420 [00:00<00:03, 109.16it/s]

Epoch: 32: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.13it/s]
Epoch: 33:   0%|                                                                                                                                                                                                             | 0/420 [00:00<?, ?it/s]


Epoch: 33: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 90.71it/s]
Epoch: 34:  26%|██████████████████████████████████████████████████▌                                                                                                                                                | 109/420 [00:01<00:03, 99.82it/s]

Epoch: 34: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.30it/s]
Epoch: 35:  12%|███████████████████████▋                                                                                                                                                                           | 51/420 [00:00<00:03, 114.62it/s]


Epoch: 35:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 415/420 [00:04<00:00, 88.48it/s]
Epoch: 35: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.17it/s]
Epoch: 35: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 397.91it/s]
Epoch: 36:  41%|███████████████████████████████████████████████████████████████████████████████▍                                                                                                                   | 171/420 [00:01<00:02, 96.38it/s]

Epoch: 36: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.09it/s]
Epoch: 37:  32%|██████████████████████████████████████████████████████████████▏                                                                                                                                    | 134/420 [00:01<00:03, 94.12it/s]

Epoch: 37: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.90it/s]
Epoch: 38:   6%|████████████▌                                                                                                                                                                                      | 27/420 [00:00<00:02, 136.38it/s]


Epoch: 38:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 403/420 [00:04<00:00, 94.69it/s]
Epoch: 38: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 93.12it/s]

Epoch: 39: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.42it/s]
Epoch: 40:  21%|████████████████████████████████████████▌                                                                                                                                                           | 87/420 [00:01<00:03, 98.13it/s]

Epoch: 40: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.01it/s]
Epoch: 40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 389.13it/s]
Epoch: 41:   6%|████████████                                                                                                                                                                                       | 26/420 [00:00<00:03, 100.40it/s]
Phase:train,Epoch 40, loss:3.1853559448605493


Epoch: 41: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.08it/s]
Epoch: 42:  36%|███████████████████████████████████████████████████████████████████████                                                                                                                            | 153/420 [00:01<00:02, 90.18it/s]

Epoch: 42: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.12it/s]
Epoch: 43:  11%|█████████████████████▊                                                                                                                                                                             | 47/420 [00:00<00:03, 106.16it/s]


Epoch: 43:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 411/420 [00:04<00:00, 81.23it/s]
Epoch: 43: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.22it/s]

Epoch: 44: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.16it/s]
Epoch: 45:  27%|███████████████████████████████████████████████████▋                                                                                                                                              | 112/420 [00:01<00:02, 106.14it/s]

Epoch: 45: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.11it/s]
Epoch: 45: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 386.55it/s]
Epoch: 46:  17%|████████████████████████████████▌                                                                                                                                                                  | 70/420 [00:00<00:03, 111.93it/s]
Phase:train,Epoch 45, loss:3.1694903186389376

Epoch: 46: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.28it/s]
Epoch: 47:   5%|█████████▎                                                                                                                                                                                          | 20/420 [00:00<00:04, 86.38it/s]


Epoch: 47: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.64it/s]
Epoch: 48:  25%|████████████████████████████████████████████████▌                                                                                                                                                 | 105/420 [00:01<00:03, 100.34it/s]

Epoch: 48: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.85it/s]
Epoch: 49:  15%|█████████████████████████████▋                                                                                                                                                                     | 64/420 [00:00<00:03, 117.52it/s]

Epoch: 49: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.64it/s]
Epoch: 50:   3%|█████                                                                                                                                                                                              | 11/420 [00:00<00:03, 102.71it/s]


Epoch: 50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.58it/s]
Epoch: 50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 384.53it/s]
Epoch: 51:  35%|███████████████████████████████████████████████████████████████████▍                                                                                                                              | 146/420 [00:01<00:02, 101.21it/s]
Phase:train,Epoch 50, loss:3.1453238413447426

Epoch: 51: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.10it/s]
Epoch: 52:  23%|████████████████████████████████████████████                                                                                                                                                       | 95/420 [00:00<00:03, 108.02it/s]

Epoch: 52: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.50it/s]
Epoch: 53:  10%|████████████████████                                                                                                                                                                                | 43/420 [00:00<00:03, 97.55it/s]


Epoch: 53: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.20it/s]
Epoch: 54:  36%|█████████████████████████████████████████████████████████████████████▎                                                                                                                            | 150/420 [00:01<00:02, 111.66it/s]

Epoch: 54: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 90.64it/s]
Epoch: 55:  23%|████████████████████████████████████████████                                                                                                                                                       | 95/420 [00:01<00:02, 108.54it/s]

Epoch: 55: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.64it/s]
Epoch: 55: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 394.05it/s]
Epoch: 56:   3%|█████                                                                                                                                                                                              | 11/420 [00:00<00:03, 109.85it/s]
Phase:train,Epoch 55, loss:3.1385538714272636


Epoch: 56: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 73.48it/s]
Epoch: 57:  10%|██████████████████▋                                                                                                                                                                                 | 40/420 [00:00<00:05, 72.41it/s]


Epoch: 57: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 81.57it/s]
Epoch: 58:  33%|███████████████████████████████████████████████████████████████▌                                                                                                                                   | 137/420 [00:01<00:03, 92.70it/s]


Epoch: 58:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 410/420 [00:05<00:00, 69.65it/s]
Epoch: 58: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 80.34it/s]

Epoch: 59: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 72.03it/s]
Epoch: 60:   4%|██████▉                                                                                                                                                                                            | 15/420 [00:00<00:02, 148.25it/s]


Epoch: 60: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.54it/s]
Epoch: 60: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 364.65it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:00<00:00, 446.72it/s]
Phase:train,Epoch 60, loss:3.117053038733346
Phase:val,Epoch 60, loss:3.439076093526987
Best epoch:40
accuracy:0.6511904761904762
precision:0.6079593564775614
recall:0.8537455410225921
f1:0.7101879327398616
confusion_matrix:[[ 752  926]
 [ 246 1436]]
fpr_all:[0.         0.         0.         ... 0.9988081  0.99940405 1.        ]
tpr_all:[0.00000000e+00 5.94530321e-04 1.18906064e-03 ... 1.00000000e+00
 1.00000000e+00 1.00000000e+00]
roc_thresh:[1.7026105  0.70261055 0.6984689  ... 0.3627709  0.3608836  0.35959956]
auc_roc:0.7235267481955048