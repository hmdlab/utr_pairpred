Total sample size:16819
Loading embedding data ...
Successflly loaded embedding data !!!
Creating train dataset ...
train,13455
Creating val dataset ...
val,1682
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:117: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  self.utr5emb = np.stack(list(np.array(self.seq_emb)[:, 0]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:117: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.utr5emb = np.stack(list(np.array(self.seq_emb)[:, 0]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:118: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  self.utr3emb = np.stack(list(np.array(self.seq_emb)[:, 1]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:118: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.utr3emb = np.stack(list(np.array(self.seq_emb)[:, 1]))
Creating test dataset ...
test,3364


Epoch: 1:  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 349/420 [00:04<00:00, 71.21it/s]
Epoch: 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 82.02it/s]
/home/ksuga/whole_mrna_predictor/.venv/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:152: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)


Epoch: 2:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 402/420 [00:05<00:00, 75.04it/s]
Epoch: 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.78it/s]

Epoch: 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.37it/s]
Epoch: 4:   0%|                                                                                                                                                                                                                   | 0/420 [00:00<?, ?it/s]


Epoch: 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.86it/s]
Epoch: 5:   4%|███████▏                                                                                                                                                                                                  | 15/420 [00:00<00:05, 73.59it/s]


Epoch: 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.83it/s]
Epoch: 5:   0%|                                                                                                                                                                                                                    | 0/52 [00:00<?, ?it/s]
Phase:train,Epoch 5, loss:3.4590617963245935
Epoch: 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 440.26it/s]

Epoch: 6:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                     | 308/420 [00:03<00:00, 127.31it/s]
Epoch: 6: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.31it/s]

Epoch: 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 100.90it/s]
Epoch: 8:  29%|██████████████████████████████████████████████████████████                                                                                                                                              | 122/420 [00:01<00:02, 117.10it/s]

Epoch: 8: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 99.00it/s]
Epoch: 9:  26%|████████████████████████████████████████████████████▊                                                                                                                                                   | 111/420 [00:01<00:02, 134.35it/s]

Epoch: 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 103.59it/s]
Epoch: 10:  26%|████████████████████████████████████████████████████                                                                                                                                                   | 110/420 [00:00<00:02, 145.64it/s]

Epoch: 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 102.57it/s]
Epoch: 10: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 478.62it/s]
Epoch: 11:   6%|███████████▍                                                                                                                                                                                            | 24/420 [00:00<00:03, 104.47it/s]
Phase:train,Epoch 10, loss:3.3653954772722154

Epoch: 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 104.58it/s]
Epoch: 12:  12%|███████████████████████▊                                                                                                                                                                                | 50/420 [00:00<00:03, 101.99it/s]

Epoch: 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 104.67it/s]
Epoch: 13:  11%|██████████████████████                                                                                                                                                                                   | 46/420 [00:00<00:04, 86.35it/s]

Epoch: 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 101.97it/s]
Epoch: 14:  15%|█████████████████████████████▌                                                                                                                                                                          | 62/420 [00:00<00:02, 138.11it/s]

Epoch: 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 99.76it/s]
Epoch: 15:  14%|████████████████████████████                                                                                                                                                                            | 59/420 [00:00<00:02, 157.57it/s]

Epoch: 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 102.96it/s]
Epoch: 15: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 436.14it/s]
Epoch: 16:   9%|██████████████████                                                                                                                                                                                      | 38/420 [00:00<00:02, 175.96it/s]
Phase:train,Epoch 15, loss:3.313797238327208


Epoch: 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 82.61it/s]
Epoch: 17:  31%|█████████████████████████████████████████████████████████████▌                                                                                                                                         | 130/420 [00:01<00:02, 115.21it/s]

Epoch: 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.81it/s]
Epoch: 18:  24%|████████████████████████████████████████████████▎                                                                                                                                                      | 102/420 [00:01<00:02, 113.38it/s]

Epoch: 18: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.51it/s]
Epoch: 19:   2%|███▊                                                                                                                                                                                                      | 8/420 [00:00<00:05, 75.63it/s]


Epoch: 19:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 382/420 [00:04<00:00, 80.77it/s]
Epoch: 19: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.99it/s]

Epoch: 20:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 371/420 [00:03<00:00, 118.38it/s]
Phase:train,Epoch 20, loss:3.2794300107728867
Epoch: 20: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.60it/s]
Epoch: 20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 442.81it/s]

Epoch: 21: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.73it/s]
Epoch: 22:  23%|██████████████████████████████████████████████▋                                                                                                                                                         | 98/420 [00:01<00:02, 113.43it/s]

Epoch: 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.57it/s]
Epoch: 23:  11%|█████████████████████▉                                                                                                                                                                                  | 46/420 [00:00<00:02, 157.31it/s]

Epoch: 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 100.78it/s]
Epoch: 24:   9%|██████████████████                                                                                                                                                                                      | 38/420 [00:00<00:02, 139.09it/s]

Epoch: 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 100.35it/s]
Epoch: 25:   3%|█████▏                                                                                                                                                                                                  | 11/420 [00:00<00:03, 109.30it/s]


Epoch: 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.95it/s]
Epoch: 25: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 437.34it/s]
Epoch: 26:  25%|█████████████████████████████████████████████████▊                                                                                                                                                     | 105/420 [00:01<00:02, 114.94it/s]
Phase:train,Epoch 25, loss:3.247981832140968

Epoch: 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 101.22it/s]
Epoch: 27:  19%|█████████████████████████████████████▎                                                                                                                                                                   | 78/420 [00:00<00:03, 87.49it/s]

Epoch: 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 102.66it/s]
Epoch: 28:  18%|███████████████████████████████████▋                                                                                                                                                                    | 75/420 [00:00<00:03, 100.28it/s]

Epoch: 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.75it/s]
Epoch: 29:  16%|███████████████████████████████▍                                                                                                                                                                        | 66/420 [00:00<00:02, 127.94it/s]

Epoch: 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.74it/s]
Epoch: 30:  11%|██████████████████████▍                                                                                                                                                                                 | 47/420 [00:00<00:03, 123.40it/s]


Epoch: 30:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 417/420 [00:04<00:00, 90.10it/s]
Phase:train,Epoch 30, loss:3.222720604283469
Epoch: 30: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.14it/s]
Epoch: 30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 455.85it/s]

Epoch: 31: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 93.30it/s]
Epoch: 32:  37%|██████████████████████████████████████████████████████████████████████████▊                                                                                                                             | 157/420 [00:01<00:02, 95.28it/s]

Epoch: 32: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 100.55it/s]
Epoch: 33:  19%|██████████████████████████████████████▊                                                                                                                                                                  | 81/420 [00:00<00:03, 91.99it/s]

Epoch: 33: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 99.89it/s]
Epoch: 34:  15%|███████████████████████████████                                                                                                                                                                          | 65/420 [00:00<00:03, 96.72it/s]

Epoch: 34: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.41it/s]
Epoch: 35:   3%|██████▏                                                                                                                                                                                                 | 13/420 [00:00<00:03, 128.39it/s]


Epoch: 35:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 414/420 [00:04<00:00, 114.81it/s]
Phase:train,Epoch 35, loss:3.2009861480622064
Epoch: 35: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.72it/s]
Epoch: 35: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 495.32it/s]

Epoch: 36:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎               | 387/420 [00:03<00:00, 120.97it/s]
Epoch: 36: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.13it/s]

Epoch: 37: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.93it/s]
Epoch: 38:  17%|██████████████████████████████████▉                                                                                                                                                                      | 73/420 [00:00<00:04, 78.11it/s]

Epoch: 38: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.70it/s]
Epoch: 39:  15%|██████████████████████████████                                                                                                                                                                          | 63/420 [00:00<00:02, 120.78it/s]

Epoch: 39: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.61it/s]
Epoch: 40:   5%|█████████                                                                                                                                                                                               | 19/420 [00:00<00:02, 179.15it/s]


Epoch: 40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.02it/s]
Epoch: 40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 433.83it/s]
Epoch: 41:  25%|██████████████████████████████████████████████████▍                                                                                                                                                     | 106/420 [00:01<00:04, 69.13it/s]
Phase:train,Epoch 40, loss:3.1816701031866526


Epoch: 41: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.60it/s]
Epoch: 42:  25%|█████████████████████████████████████████████████▌                                                                                                                                                      | 104/420 [00:01<00:04, 68.39it/s]


Epoch: 42: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.36it/s]
Epoch: 43:  16%|████████████████████████████████                                                                                                                                                                         | 67/420 [00:00<00:05, 68.23it/s]


Epoch: 43: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.24it/s]
Epoch: 44:  15%|██████████████████████████████▋                                                                                                                                                                          | 64/420 [00:00<00:05, 70.39it/s]


Epoch: 44: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.69it/s]
Epoch: 45:  15%|███████████████████████████████                                                                                                                                                                          | 65/420 [00:00<00:05, 68.51it/s]

Epoch: 45: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.23it/s]
Epoch: 45: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 588.79it/s]
Epoch: 46:   3%|██████▏                                                                                                                                                                                                 | 13/420 [00:00<00:03, 124.46it/s]
Phase:train,Epoch 45, loss:3.159479597068968


Epoch: 46: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.04it/s]
Epoch: 47:  29%|██████████████████████████████████████████████████████████                                                                                                                                              | 122/420 [00:01<00:03, 79.49it/s]

Epoch: 47: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.23it/s]
Epoch: 48:  20%|████████████████████████████████████████▏                                                                                                                                                                | 84/420 [00:00<00:04, 79.40it/s]

Epoch: 48: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.22it/s]
Epoch: 49:   7%|█████████████▉                                                                                                                                                                                           | 29/420 [00:00<00:04, 78.50it/s]


Epoch: 49:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 401/420 [00:04<00:00, 80.16it/s]
Epoch: 49: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.90it/s]

Epoch: 50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.07it/s]
Epoch: 50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 583.24it/s]
Epoch: 51:  23%|█████████████████████████████████████████████▍                                                                                                                                                           | 95/420 [00:01<00:04, 75.17it/s]
Phase:train,Epoch 50, loss:3.148515550295512

Epoch: 51: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.58it/s]
Epoch: 52:  13%|██████████████████████████▊                                                                                                                                                                              | 56/420 [00:00<00:05, 71.02it/s]


Epoch: 52:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎               | 387/420 [00:04<00:00, 85.73it/s]
Epoch: 52: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 85.69it/s]

Epoch: 53: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.36it/s]
Epoch: 54:  21%|███████████████████████████████████████████                                                                                                                                                              | 90/420 [00:00<00:03, 82.79it/s]

Epoch: 54: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.68it/s]
Epoch: 55:  10%|███████████████████▏                                                                                                                                                                                     | 40/420 [00:00<00:05, 73.82it/s]


Epoch: 55:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 413/420 [00:04<00:00, 77.33it/s]
Phase:train,Epoch 55, loss:3.1277996750104995
Epoch: 55: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.33it/s]
Epoch: 55: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 435.15it/s]

Epoch: 56: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.50it/s]
Epoch: 57:  23%|█████████████████████████████████████████████▉                                                                                                                                                           | 96/420 [00:01<00:04, 70.57it/s]


Epoch: 57: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.09it/s]
Epoch: 58:  17%|██████████████████████████████████▍                                                                                                                                                                      | 72/420 [00:01<00:04, 70.80it/s]


Epoch: 58: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.87it/s]
Epoch: 59:  21%|██████████████████████████████████████████                                                                                                                                                               | 88/420 [00:01<00:04, 70.27it/s]


Epoch: 59: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.71it/s]
Epoch: 60:  25%|█████████████████████████████████████████████████▌                                                                                                                                                      | 104/420 [00:01<00:04, 75.59it/s]


Epoch: 60: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.86it/s]
Epoch: 60: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 437.21it/s]
Epoch: 61:  30%|███████████████████████████████████████████████████████████▌                                                                                                                                            | 125/420 [00:01<00:04, 72.49it/s]
Phase:train,Epoch 60, loss:3.1095119181133453

Epoch: 61: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 73.19it/s]
Epoch: 62:   0%|                                                                                                                                                                                                                  | 0/420 [00:00<?, ?it/s]



Epoch: 62:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 400/420 [00:05<00:00, 70.65it/s]
Epoch: 62: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.83it/s]


Epoch: 63:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 417/420 [00:05<00:00, 70.36it/s]
Epoch: 63: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.96it/s]

Epoch: 64: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 72.13it/s]
Epoch: 65:   4%|███████▋                                                                                                                                                                                                 | 16/420 [00:00<00:05, 75.06it/s]


Epoch: 65: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.01it/s]
Epoch: 65: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 405.27it/s]
Epoch: 66:   9%|█████████████████▋                                                                                                                                                                                       | 37/420 [00:00<00:04, 93.79it/s]
Phase:train,Epoch 65, loss:3.094061599458967


Epoch: 66: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 74.29it/s]
Epoch: 67:   6%|███████████▍                                                                                                                                                                                             | 24/420 [00:00<00:05, 70.69it/s]


Epoch: 67: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.49it/s]
Epoch: 68:  39%|████████████████████████████████████████████████████████████████████████████▊                                                                                                                          | 162/420 [00:01<00:02, 120.15it/s]

Epoch: 68: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.65it/s]
Epoch: 69:  19%|██████████████████████████████████████▎                                                                                                                                                                  | 80/420 [00:01<00:04, 70.48it/s]


Epoch: 69: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 72.05it/s]
Epoch: 70:  25%|█████████████████████████████████████████████████▌                                                                                                                                                      | 104/420 [00:01<00:04, 70.75it/s]


Epoch: 70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.92it/s]
Epoch: 70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 433.55it/s]
Epoch: 71:  23%|█████████████████████████████████████████████▉                                                                                                                                                           | 96/420 [00:01<00:04, 74.81it/s]
Phase:train,Epoch 70, loss:3.090527029264541


Epoch: 71: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 74.98it/s]
Epoch: 72:  29%|█████████████████████████████████████████████████████████▏                                                                                                                                              | 120/420 [00:01<00:04, 70.36it/s]


Epoch: 72: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.27it/s]
Epoch: 73:  32%|████████████████████████████████████████████████████████████████▊                                                                                                                                       | 136/420 [00:01<00:04, 70.51it/s]

Epoch: 73: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.67it/s]
Epoch: 74:   4%|███████▋                                                                                                                                                                                                 | 16/420 [00:00<00:05, 74.79it/s]


Epoch: 74: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 70.84it/s]
Epoch: 75:   6%|███████████▍                                                                                                                                                                                             | 24/420 [00:00<00:05, 75.47it/s]


Epoch: 75: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 72.14it/s]
Epoch: 75: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 444.70it/s]
Epoch: 76:   3%|█████▋                                                                                                                                                                                                  | 12/420 [00:00<00:03, 119.69it/s]
Phase:train,Epoch 75, loss:3.0829286984034945
Epoch: 76:  38%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                           | 160/420 [00:02<00:03, 68.22it/s]
Epoch: 76:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                  | 315/420 [00:04<00:01, 72.70it/s]
Epoch: 77:  10%|███████████████████▏                                                                                                                                                                                     | 40/420 [00:00<00:05, 70.94it/s]
Epoch: 77:  10%|███████████████████▏                                                                                                                                                                                     | 40/420 [00:00<00:05, 70.94it/s]
Epoch: 77:  46%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                            | 193/420 [00:02<00:03, 72.36it/s]
Epoch: 77:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 337/420 [00:04<00:01, 70.46it/s]
Epoch: 78:  15%|██████████████████████████████▋                                                                                                                                                                          | 64/420 [00:00<00:05, 71.00it/s]
Epoch: 78:  15%|██████████████████████████████▋                                                                                                                                                                          | 64/420 [00:00<00:05, 71.00it/s]
Epoch: 78:  50%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                     | 208/420 [00:02<00:03, 70.47it/s]
Epoch: 78:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 361/420 [00:05<00:00, 73.97it/s]
Epoch: 79:  20%|███████████████████████████████████████▏                                                                                                                                                                 | 82/420 [00:01<00:04, 71.65it/s]
Epoch: 79:  20%|███████████████████████████████████████▏                                                                                                                                                                 | 82/420 [00:01<00:04, 71.65it/s]
Epoch: 79:  67%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 281/420 [00:03<00:01, 103.58it/s]
Epoch: 80:  13%|██████████████████████████▏                                                                                                                                                                             | 55/420 [00:00<00:02, 123.97it/s]
Epoch: 80:  13%|██████████████████████████▏                                                                                                                                                                             | 55/420 [00:00<00:02, 123.97it/s]
Epoch: 80:  41%|█████████████████████████████████████████████████████████████████████████████████▍                                                                                                                      | 171/420 [00:01<00:03, 72.85it/s]
Epoch: 80:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                              | 323/420 [00:04<00:01, 70.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:00<00:00, 560.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:00<00:00, 560.55it/s]
Phase:train,Epoch 80, loss:3.0789599850064233
Phase:val,Epoch 80, loss:3.450687486391801
Best epoch:45
accuracy:0.643154761904762
precision:0.6005830903790087
recall:0.8573127229488704
f1:0.7063433749693854
confusion_matrix:[[ 719  959]
 [ 240 1442]]
fpr_all:[0.         0.         0.         ... 0.9988081  0.99940405 1.        ]
tpr_all:[0.00000000e+00 5.94530321e-04 1.18906064e-03 ... 1.00000000e+00
 1.00000000e+00 1.00000000e+00]
roc_thresh:[1.717696   0.7176959  0.709139   ... 0.36740118 0.3635279  0.3619628 ]
auc_roc:0.7174588541083533