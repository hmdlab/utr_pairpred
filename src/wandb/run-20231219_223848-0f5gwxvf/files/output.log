Total sample size:16819
Loading embedding data ...
Successflly loaded embedding data !!!
Creating train dataset ...
train,13455
Creating val dataset ...
val,1682
Creating test dataset ...
test,3364
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:117: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  self.utr5emb = np.stack(list(np.array(self.seq_emb)[:, 0]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:117: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.utr5emb = np.stack(list(np.array(self.seq_emb)[:, 0]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:118: FutureWarning: The input object of type 'Tensor' is an array-like implementing one of the corresponding protocols (`__array__`, `__array_interface__` or `__array_struct__`); but not a sequence (or 0-D). In the future, this object will be coerced as if it was first converted using `np.array(obj)`. To retain the old behaviour, you have to either modify the type 'Tensor', or assign to an empty array created with `np.empty(correct_shape, dtype=object)`.
  self.utr3emb = np.stack(list(np.array(self.seq_emb)[:, 1]))
/home/ksuga/whole_mrna_predictor/UTR_PairPred/src/dataset.py:118: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.utr3emb = np.stack(list(np.array(self.seq_emb)[:, 1]))


Epoch: 1:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                      | 340/420 [00:05<00:01, 66.83it/s]
Epoch: 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 62.42it/s]
/home/ksuga/whole_mrna_predictor/.venv/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:152: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)


Epoch: 2:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 367/420 [00:04<00:00, 75.91it/s]
Epoch: 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 74.23it/s]


Epoch: 3:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 374/420 [00:05<00:00, 69.22it/s]
Epoch: 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.85it/s]


Epoch: 4:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                | 386/420 [00:05<00:00, 69.21it/s]
Epoch: 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 71.17it/s]


Epoch: 5:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 363/420 [00:05<00:00, 69.37it/s]
Phase:train,Epoch 5, loss:3.4543458382288614
Epoch: 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.26it/s]
Epoch: 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 432.12it/s]

Epoch: 6: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.44it/s]
Epoch: 7:  10%|████████████████████▋                                                                                                                                                                                     | 43/420 [00:00<00:04, 81.93it/s]


Epoch: 7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 73.16it/s]
Epoch: 8:  16%|████████████████████████████████▏                                                                                                                                                                         | 67/420 [00:00<00:05, 69.37it/s]


Epoch: 8: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.16it/s]
Epoch: 9:  17%|██████████████████████████████████▋                                                                                                                                                                       | 72/420 [00:01<00:05, 69.27it/s]


Epoch: 9: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.84it/s]
Epoch: 10:  16%|████████████████████████████████▊                                                                                                                                                                       | 69/420 [00:00<00:03, 105.89it/s]


Epoch: 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.35it/s]
Phase:train,Epoch 10, loss:3.3578167807488213
Phase:val,Epoch 10, loss:3.7804482716780443
Epoch: 10: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 397.33it/s]

Epoch: 11:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 384/420 [00:03<00:00, 90.12it/s]
Epoch: 11: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 96.95it/s]

Epoch: 12:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 349/420 [00:03<00:00, 80.65it/s]
Epoch: 12: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 93.19it/s]

Epoch: 13: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 79.37it/s]
Epoch: 14:   0%|                                                                                                                                                                                                                  | 0/420 [00:00<?, ?it/s]


Epoch: 14:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 374/420 [00:04<00:00, 86.75it/s]
Epoch: 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.30it/s]

Epoch: 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.78it/s]
Epoch: 15: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 433.91it/s]
Epoch: 16:  11%|██████████████████████▊                                                                                                                                                                                 | 48/420 [00:00<00:03, 105.02it/s]
Phase:train,Epoch 15, loss:3.305565745489938


Epoch: 16:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 395/420 [00:04<00:00, 80.37it/s]
Epoch: 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 84.08it/s]

Epoch: 17:  84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 354/420 [00:03<00:00, 90.78it/s]
Epoch: 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 96.75it/s]

Epoch: 18:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 324/420 [00:03<00:01, 88.82it/s]
Epoch: 18: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.60it/s]

Epoch: 19: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.09it/s]
Epoch: 20:  14%|███████████████████████████▎                                                                                                                                                                             | 57/420 [00:00<00:04, 75.09it/s]


Epoch: 20:  86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 361/420 [00:04<00:00, 92.30it/s]
Phase:train,Epoch 20, loss:3.273595280874343
Epoch: 20: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 84.07it/s]
Epoch: 20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 552.72it/s]

Epoch: 21: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.95it/s]
Epoch: 22:  22%|████████████████████████████████████████████▌                                                                                                                                                            | 93/420 [00:01<00:03, 85.13it/s]

Epoch: 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.93it/s]
Epoch: 23:  16%|████████████████████████████████                                                                                                                                                                         | 67/420 [00:00<00:03, 92.12it/s]

Epoch: 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.62it/s]
Epoch: 24:   6%|███████████▍                                                                                                                                                                                             | 24/420 [00:00<00:05, 72.05it/s]

Epoch: 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 100.55it/s]
Epoch: 25:   4%|███████▋                                                                                                                                                                                                 | 16/420 [00:00<00:05, 72.46it/s]


Epoch: 25:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 378/420 [00:04<00:00, 81.28it/s]
Phase:train,Epoch 25, loss:3.2420027755555654
Epoch: 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.76it/s]
Epoch: 25: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 555.58it/s]

Epoch: 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.72it/s]
Epoch: 27:  20%|████████████████████████████████████████▍                                                                                                                                                               | 85/420 [00:00<00:03, 105.81it/s]

Epoch: 27: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 93.90it/s]
Epoch: 28:  11%|█████████████████████▌                                                                                                                                                                                   | 45/420 [00:00<00:03, 95.50it/s]

Epoch: 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 98.01it/s]
Epoch: 29:   4%|████████▌                                                                                                                                                                                                | 18/420 [00:00<00:05, 76.36it/s]

Epoch: 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 96.11it/s]
Epoch: 30:   0%|                                                                                                                                                                                                                  | 0/420 [00:00<?, ?it/s]


Epoch: 30:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                | 385/420 [00:04<00:00, 88.07it/s]
Phase:train,Epoch 30, loss:3.2188615742183866
Epoch: 30: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.69it/s]
Epoch: 30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 590.09it/s]

Epoch: 31:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 352/420 [00:03<00:00, 83.19it/s]
Epoch: 31: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 98.88it/s]

Epoch: 32: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 90.99it/s]
Epoch: 33:  10%|███████████████████▏                                                                                                                                                                                     | 40/420 [00:00<00:04, 91.27it/s]

Epoch: 33: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 96.61it/s]
Epoch: 34:   4%|████████▌                                                                                                                                                                                                | 18/420 [00:00<00:04, 81.74it/s]


Epoch: 34:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 389/420 [00:04<00:00, 70.84it/s]
Epoch: 34: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.27it/s]

Epoch: 35:  81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                     | 341/420 [00:03<00:01, 70.20it/s]
Epoch: 35: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.01it/s]
Epoch: 35: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 544.09it/s]
Epoch: 36:  25%|██████████████████████████████████████████████████▉                                                                                                                                                     | 107/420 [00:01<00:04, 68.00it/s]

Epoch: 36: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.85it/s]
Epoch: 37:   3%|██████▋                                                                                                                                                                                                  | 14/420 [00:00<00:05, 68.14it/s]


Epoch: 37:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 378/420 [00:04<00:00, 73.05it/s]
Epoch: 37: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.42it/s]

Epoch: 38: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.04it/s]
Epoch: 39:  19%|██████████████████████████████████████▊                                                                                                                                                                  | 81/420 [00:01<00:05, 67.32it/s]

Epoch: 39: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.84it/s]
Epoch: 40:   7%|█████████████▉                                                                                                                                                                                           | 29/420 [00:00<00:05, 67.48it/s]


Epoch: 40:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████          | 399/420 [00:04<00:00, 70.29it/s]
Phase:train,Epoch 40, loss:3.182828974723816
Epoch: 40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 87.86it/s]
Epoch: 40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 496.24it/s]

Epoch: 41: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.94it/s]
Epoch: 42:  19%|██████████████████████████████████████▎                                                                                                                                                                  | 80/420 [00:01<00:05, 67.42it/s]


Epoch: 42:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 383/420 [00:04<00:00, 73.50it/s]
Epoch: 42: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 78.18it/s]

Epoch: 43: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 84.85it/s]
Epoch: 44:  12%|████████████████████████▍                                                                                                                                                                                | 51/420 [00:00<00:05, 69.26it/s]


Epoch: 44: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 68.97it/s]
Epoch: 45:  11%|██████████████████████▍                                                                                                                                                                                  | 47/420 [00:00<00:05, 69.58it/s]


Epoch: 45: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.08it/s]
Epoch: 45: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 435.46it/s]
Epoch: 46:   6%|███████████▍                                                                                                                                                                                             | 24/420 [00:00<00:04, 97.03it/s]
Phase:train,Epoch 45, loss:3.15981444971902


Epoch: 46:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 381/420 [00:04<00:00, 92.95it/s]
Epoch: 46: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.70it/s]

Epoch: 47: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 97.49it/s]
Epoch: 48:  22%|████████████████████████████████████████████▌                                                                                                                                                            | 93/420 [00:01<00:04, 69.28it/s]


Epoch: 48: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.45it/s]
Epoch: 49:  24%|████████████████████████████████████████████████                                                                                                                                                        | 101/420 [00:01<00:04, 69.20it/s]


Epoch: 49: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.08it/s]
Epoch: 50:  26%|███████████████████████████████████████████████████▉                                                                                                                                                    | 109/420 [00:01<00:04, 69.20it/s]


Epoch: 50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:06<00:00, 69.07it/s]
Epoch: 50: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 434.00it/s]
Epoch: 51:  18%|████████████████████████████████████▎                                                                                                                                                                    | 76/420 [00:00<00:04, 71.76it/s]
Phase:train,Epoch 50, loss:3.139051986308325


Epoch: 51: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:05<00:00, 73.45it/s]
Epoch: 52:  28%|████████████████████████████████████████████████████████▏                                                                                                                                               | 118/420 [00:01<00:03, 83.28it/s]

Epoch: 52: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.20it/s]
Epoch: 53:  20%|████████████████████████████████████████▋                                                                                                                                                                | 85/420 [00:00<00:03, 91.39it/s]

Epoch: 53: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 101.20it/s]
Epoch: 54:  14%|███████████████████████████▎                                                                                                                                                                             | 57/420 [00:00<00:04, 79.36it/s]

Epoch: 54: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 89.70it/s]
Epoch: 55:   2%|███▎                                                                                                                                                                                                      | 7/420 [00:00<00:05, 68.99it/s]


Epoch: 55: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.14it/s]
Epoch: 55: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 477.57it/s]
Epoch: 56:  29%|█████████████████████████████████████████████████████████▎                                                                                                                                             | 121/420 [00:01<00:02, 100.10it/s]
Phase:train,Epoch 55, loss:3.133356165318262

Epoch: 56: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 99.93it/s]
Epoch: 57:  21%|█████████████████████████████████████████▋                                                                                                                                                               | 87/420 [00:00<00:03, 88.07it/s]

Epoch: 57: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 90.90it/s]
Epoch: 58:   9%|█████████████████▋                                                                                                                                                                                       | 37/420 [00:00<00:05, 76.33it/s]

Epoch: 58: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 95.96it/s]
Epoch: 59:   2%|███▊                                                                                                                                                                                                      | 8/420 [00:00<00:05, 72.40it/s]


Epoch: 59:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 406/420 [00:04<00:00, 81.31it/s]
Epoch: 59: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.85it/s]

Epoch: 60: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 99.48it/s]
Epoch: 60: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 532.80it/s]
Epoch: 61:  23%|██████████████████████████████████████████████▉                                                                                                                                                          | 98/420 [00:01<00:03, 91.27it/s]
Phase:train,Epoch 60, loss:3.1185611889475866

Epoch: 61: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 90.81it/s]
Epoch: 62:  14%|███████████████████████████▊                                                                                                                                                                             | 58/420 [00:00<00:04, 83.55it/s]

Epoch: 62: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.89it/s]
Epoch: 63:   4%|███████▋                                                                                                                                                                                                 | 16/420 [00:00<00:05, 73.85it/s]


Epoch: 63:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 398/420 [00:04<00:00, 79.74it/s]
Epoch: 63: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 91.55it/s]

Epoch: 64: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 103.44it/s]
Epoch: 65:  41%|█████████████████████████████████████████████████████████████████████████████████▍                                                                                                                      | 171/420 [00:01<00:03, 80.17it/s]

Epoch: 65: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 99.71it/s]
Epoch: 65: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 499.81it/s]
Epoch: 66:  36%|████████████████████████████████████████████████████████████████████████▍                                                                                                                               | 152/420 [00:01<00:03, 80.67it/s]
Phase:train,Epoch 65, loss:3.098011799085708


Epoch: 66: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 98.21it/s]
Epoch: 67: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.12it/s]
Epoch: 68:  13%|█████████████████████████▏                                                                                                                                                                              | 53/420 [00:00<00:03, 103.68it/s]
Phase:train,Epoch 66, loss:3.102636646656763

Epoch: 68: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 94.40it/s]
Epoch: 69:   2%|███▊                                                                                                                                                                                                      | 8/420 [00:00<00:05, 72.91it/s]


Epoch: 69: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.79it/s]
Epoch: 70:  31%|██████████████████████████████████████████████████████████████▍                                                                                                                                         | 131/420 [00:01<00:03, 76.53it/s]

Epoch: 70: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 86.50it/s]
Epoch: 70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 557.08it/s]
Epoch: 71:  15%|█████████████████████████████▋                                                                                                                                                                           | 62/420 [00:00<00:04, 76.65it/s]
Phase:train,Epoch 70, loss:3.0956673803783596

Epoch: 71: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 98.88it/s]
Epoch: 72:   9%|██████████████████▋                                                                                                                                                                                      | 39/420 [00:00<00:05, 68.32it/s]


Epoch: 72: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 88.74it/s]
Epoch: 73:  32%|███████████████████████████████████████████████████████████████▎                                                                                                                                        | 133/420 [00:01<00:03, 91.86it/s]

Epoch: 73: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 90.40it/s]
Epoch: 74:  19%|██████████████████████████████████████▎                                                                                                                                                                  | 80/420 [00:00<00:03, 93.20it/s]

Epoch: 74: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 93.15it/s]
Epoch: 75:   9%|██████████████████▏                                                                                                                                                                                      | 38/420 [00:00<00:04, 77.66it/s]

Epoch: 75: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:04<00:00, 92.94it/s]
Epoch: 75:   0%|                                                                                                                                                                                                                   | 0/52 [00:00<?, ?it/s]
Phase:train,Epoch 75, loss:3.083728127820151
Epoch: 75: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:00<00:00, 442.07it/s]
Epoch: 76:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 359/420 [00:04<00:00, 74.10it/s]
Epoch: 77:  33%|██████████████████████████████████████████████████████████████████▏                                                                                                                                     | 139/420 [00:01<00:03, 82.01it/s]
Epoch: 77:  33%|██████████████████████████████████████████████████████████████████▏                                                                                                                                     | 139/420 [00:01<00:03, 82.01it/s]
Epoch: 77:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                              | 323/420 [00:03<00:01, 77.61it/s]
Epoch: 78:  11%|██████████████████████▍                                                                                                                                                                                  | 47/420 [00:00<00:03, 97.09it/s]
Epoch: 78:  11%|██████████████████████▍                                                                                                                                                                                  | 47/420 [00:00<00:03, 97.09it/s]
Epoch: 78:  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 230/420 [00:02<00:01, 98.78it/s]
Epoch: 79:   0%|                                                                                                                                                                                                                  | 0/420 [00:00<?, ?it/s]
Epoch: 79:   0%|                                                                                                                                                                                                                  | 0/420 [00:00<?, ?it/s]
Epoch: 79:  50%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                     | 208/420 [00:02<00:02, 91.38it/s]
Epoch: 79:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 406/420 [00:04<00:00, 100.19it/s]
Epoch: 79:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 406/420 [00:04<00:00, 100.19it/s]
Epoch: 80:  44%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                | 183/420 [00:01<00:02, 93.81it/s]
Epoch: 80:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                      | 372/420 [00:03<00:00, 91.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:00<00:00, 569.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:00<00:00, 569.32it/s]
Phase:train,Epoch 80, loss:3.084432616120293
Phase:val,Epoch 80, loss:3.553292457874005
Best epoch:45
accuracy:0.6514880952380953
precision:0.6121105748135147
recall:0.8293697978596909
f1:0.7043675839434487
confusion_matrix:[[ 794  884]
 [ 287 1395]]
fpr_all:[0.         0.         0.         ... 0.9988081  0.99940405 1.        ]
tpr_all:[0.00000000e+00 5.94530321e-04 1.18906064e-03 ... 1.00000000e+00
 1.00000000e+00 1.00000000e+00]
roc_thresh:[1.7107322  0.7107322  0.7055765  ... 0.36763123 0.361818   0.3578734 ]
auc_roc:0.7207071580316866